# Pandas

판다스 패키지는 시계열이나 표형태를 다루기 위한 Series 클래스와 Dataframe 클래스를 제공한다. 

## 1. Series 

시리즈 클래스 = value + index 이다.

### 1.1 시리즈 생성

인덱스를 지정하고 생성

```python
s = pd.Series([9904312, 3448737, 2890451, 2466052],
              index=["서울", "부산", "인천", "대구"])
s
---------------------------------------------------
서울    9904312
부산    3448737
인천    2890451
대구    2466052
dtype: int64
```

```python
s.index
-----------------------------
Index(['서울','부산','인천','대구'], dtype='objet')
```

```python
s.values #numpy에서 생성한 ndarray 와 같은 형태
-----------------------------
array([9904312, 3448737, 2890451, 2466052])  
```

인덱스 없이 생성

```python
pd.Series(range(10,14))
------------------------
0    10
1    11
2    12
3    13
dtype: int64
```

### 1.2 시리즈 인덱싱

```python
s = pd.Series([9904312, 3448737, 2890451, 2466052],
              index=["서울", "부산", "인천", "대구"])
```

#### 인덱싱

```python
s[1], s["부산"] #배열의 인덱스 방법도 가능하고, 인덱스 라벨도 가능한다
-----------------------------------
(3448737, 3448737)
```

#### 배열로 인덱싱 하기

```python
s[[0,3,1]]
-------------------------------------
서울    9904312
대구    2466052
부산    3448737
dtype: int64
```

```python
s[["서울", "대구", "부산"]]
-------------------------------------
서울    9904312
대구    2466052
부산    3448737
dtype: int64s[["서울", "대구", "부산"]]
```

#### 슬라이싱

```python
s[1:3]
----------------------
부산    3448737
인천    2890451
dtype: int64
```

#### 시리즈는 딕셔너리 자료형

```python
s = pd.Series([9904312, 3448737, 2890451, 2466052],
              index=["서울", "부산", "인천", "대구"])
```



시리즈 객체는 딕셔너리 객체와 동일한 연산을 수행한다.

```python
'서울' in s
-------------------
True
```

시리즈 순회

```python
for k, v in s.items():
    print(f"{k}={v}")
-------------------------
서울=9904312
부산=3448737
인천=2890451
대구=2466052
```

데이터 갱신, 추가, 삭제

```python
s['부산'] = 9900000
del s['서울']
s
-----------------------------
부산    9900000
인천    2890451
대구    2466052
dtype: int64
```



###  1.3 인덱스 기반 연산

pandas는 인덱스가 같은 값에 대해서 매핑한 다음 연산을 수행하는 방법을 제공한다.

```python
인구_2015 = pd.Series([9904312, 3448737, 2890451, 2466052],
              index=["서울", "부산", "인천", "대구"])
인구_2010 = pd.Series({"서울": 9631482, "부산": 3393191, "인천": 2632035, "대전": 1490158})
```

인덱스와 상관없이 계산한 경우는 다음과 같이 엉뚱한 값이 나온다. 

```python
인구_2015.values-인구_2010.values
-------------------------------------
array([272830,  55546, 258416, 975894], dtype=int64)
```

인덱스 기반 연산

```python
인구_2015-인구_2010
--------------------------
대구         NaN
대전         NaN
부산     55546.0
서울    272830.0
인천    258416.0
dtype: float64
```

인덱스 기반 연산을 수행한후 NaN을 제거

``` python
ds = 인구_2015-인구_2010
ds[ds.notnull()]
--------------------------------
부산     55546.0
서울    272830.0
인천    258416.0
dtype: float64
```

인구증가율은 다음과 같이 구할 수 있다.

``` python
rs = (인구_2015-인구_2010)/인구_2010  * 100
rs = rs[rs.notnull()]
rs
-----------------------------------------
부산    1.636984
서울    2.832690
인천    9.818107
dtype: float64
```

## 2. 데이터 프레임

시리즈는 1차원 벡터데이터라면 DataFrame 클래스는 2차원 테이블 형태, Series 는 row index 만 가지고 있다면  DataFrame 은 row index 뿐만 아니라 column index 도 가지고 있다.

### 2.1 데이터프레임 생성

데이터,  row index, column index를 준비한 다음에 dataframe 에 넣는다.

```python
data = {
    "2015": [9904312, 3448737, 2890451, 2466052],
    "2010": [9631482, 3393191, 2632035, 2431774],
    "2005": [9762546, 3512547, 2517680, 2456016],
    "2000": [9853972, 3655437, 2466338, 2473990],
    "지역": ["수도권", "경상권", "수도권", "경상권"],
    "2010-2015 증가율": [0.0283, 0.0163, 0.0982, 0.0141]
}
columns = ["지역", "2015", "2010", "2005", "2000", "2010-2015 증가율"]
index = ["서울", "부산", "인천", "대구"]
df = pd.DataFrame(data, index=index, columns=columns)
df
```

|      |   지역 |    2015 |    2010 |    2005 |    2000 | 2010-2015 증가율 |
| ---: | -----: | ------: | ------: | ------: | ------: | ---------------- |
| 서울 | 수도권 | 9904312 | 9631482 | 9762546 | 9853972 | 0.0283           |
| 부산 | 경상권 | 3448737 | 3393191 | 3512547 | 3655437 | 0.0163           |
| 인천 | 수도권 | 2890451 | 2632035 | 2517680 | 2466338 | 0.0982           |
| 대구 | 경상권 | 2466052 | 2431774 | 2456016 | 2473990 | 0.0141           |

df.values, df.columns, df.index  정보 확인하기

```python
df.values
-------------------------------------------------------------------
array([['수도권', 9904312, 9631482, 9762546, 9853972, 0.0283],
       ['경상권', 3448737, 3393191, 3512547, 3655437, 0.0163],
       ['수도권', 2890451, 2632035, 2517680, 2466338, 0.0982],
       ['경상권', 2466052, 2431774, 2456016, 2473990, 0.0141]], dtype=object)
df.columns
```

```python
df.columns
--------------------------------------------------------------------
Index(['지역', '2015', '2010', '2005', '2000', '2010-2015 증가율'], dtype='object')
```

```python
df.index
---------------------------------------------------------------------
Index(['서울', '부산', '인천', '대구'], dtype='object')
```

### 2.2 열단위 데이터 갱신

``` python
df["2010-2015 증가율"] = df["2010-2015 증가율"] * 100
df
```

|      |   지역 |    2015 |    2010 |    2005 |    2000 | 2010-2015 증가율 |
| ---: | -----: | ------: | ------: | ------: | ------: | ---------------: |
| 서울 | 수도권 | 9904312 | 9631482 | 9762546 | 9853972 |             2.83 |
| 부산 | 경상권 | 3448737 | 3393191 | 3512547 | 3655437 |             1.63 |
| 인천 | 수도권 | 2890451 | 2632035 | 2517680 | 2466338 |             9.82 |
| 대구 | 경상권 | 2466052 | 2431774 | 2456016 | 2473990 |             1.41 |

```python
df["2005-2010 증가율"] = ((df["2010"] - df["2005"]) / df["2005"] * 100).round(2)
df
```

|      |   지역 |    2015 |    2010 |    2005 |    2000 | 2010-2015 증가율 | 2005-2010 증가율 |
| ---: | -----: | ------: | ------: | ------: | ------: | ---------------: | ---------------: |
| 서울 | 수도권 | 9904312 | 9631482 | 9762546 | 9853972 |             2.83 |            -1.34 |
| 부산 | 경상권 | 3448737 | 3393191 | 3512547 | 3655437 |             1.63 |            -3.40 |
| 인천 | 수도권 | 2890451 | 2632035 | 2517680 | 2466338 |             9.82 |             4.54 |
| 대구 | 경상권 | 2466052 | 2431774 | 2456016 | 2473990 |             1.41 |            -0.99 |

### 2.3 열인덱싱

